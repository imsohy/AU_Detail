import os, sys
import random
import cv2
import numpy as np
from skimage.io import imread
from skimage.transform import estimate_transform, warp, resize, rescale
import torch
from torch.utils.data import Dataset, ConcatDataset
from glob import glob

import torch.nn.functional as F
def build_train(config, is_train=True):
    data_list = []
    data_list.append(SelfDataset(K=config.K,  image_size=config.image_size , mediapipePath = config.mediapipePath))
    dataset = ConcatDataset(data_list)
    return dataset


class SelfDataset(Dataset):
    def __init__(self, K,  image_size, mediapipePath = 'mediapipe_landmark_embedding.npz'):
        '''
        K must be less than 6
        '''
        random.seed(0)

        self.mediapipe_idx = \
            np.load(mediapipePath,
                    allow_pickle=True, encoding='latin1')[
                'landmark_indices'].astype(int)
        self.K = K
        # allName = ['FFHQ', 'FFHQ-Aug', 'CelebAHQ', 'CelebAHQ-Aug']
        self.image_size = image_size
        #
        # self.source1 = '/media/cine/de6afd1d-c444-4d43-a787-079519ace719/MEAD_Dataset_25/masks/'
        self.source2 = '/media/cine/First/Aff-wild2/masks/'
        # self.MEADAll = glob(os.path.join(self.source1, "*/*/*/*/"))
        # random.shuffle(self.MEADAll)

        # self.masksList = self.MEADAll[:3000]+glob(os.path.join(self.source2, "*/*/"))+glob(os.path.join(self.source2, "*/*/"))+glob(os.path.join(self.source2, "*/*/"))+glob(os.path.join(self.source2, "*/*/"))# [26400:26400+40] #[736+782+615:]# [267+219+58:267+219+58+90] #
        self.temp =  glob(os.path.join(self.source2, "*/*/"))
        random.shuffle(self.temp)


        self.masksList =self.temp[:int(len(self.temp)*0.7)]
        print(self.temp[int(len(self.temp)*0.7):])
    # ['/media/cine/First/Aff-wild2/masks/84-30-1920x1080_sequence/43/', '/media/cine/First/Aff-wild2/masks/video82_sequence/137/', '/media/cine/First/Aff-wild2/masks/video82_sequence/538/', '/media/cine/First/Aff-wild2/masks/92-24-1920x1080_sequence/22/', '/media/cine/First/Aff-wild2/masks/video14_sequence/137/', '/media/cine/First/Aff-wild2/masks/video14_sequence/116/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/12/', '/media/cine/First/Aff-wild2/masks/video95_sequence/41/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/238/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/120/', '/media/cine/First/Aff-wild2/masks/131-30-1920x1080_sequence/401/', '/media/cine/First/Aff-wild2/masks/122-60-1920x1080-1_sequence/30/', '/media/cine/First/Aff-wild2/masks/137-30-1920x1080_sequence/282/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/330/', '/media/cine/First/Aff-wild2/masks/74-25-1920x1080_sequence/6/', '/media/cine/First/Aff-wild2/masks/video44_sequence/45/', '/media/cine/First/Aff-wild2/masks/video27_sequence/670/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/103/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/31/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/253/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/121/', '/media/cine/First/Aff-wild2/masks/video52_sequence/99/', '/media/cine/First/Aff-wild2/masks/90-30-1080x1920_sequence/107/', '/media/cine/First/Aff-wild2/masks/video85_sequence/22/', '/media/cine/First/Aff-wild2/masks/video44_sequence/42/', '/media/cine/First/Aff-wild2/masks/video40_sequence/87/', '/media/cine/First/Aff-wild2/masks/16-30-1920x1080_sequence/39/', '/media/cine/First/Aff-wild2/masks/video27_sequence/33/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/5/', '/media/cine/First/Aff-wild2/masks/121-24-1920x1080_sequence/53/', '/media/cine/First/Aff-wild2/masks/101-30-1080x1920_sequence/107/', '/media/cine/First/Aff-wild2/masks/66-25-1080x1920_sequence/124/', '/media/cine/First/Aff-wild2/masks/87-25-1920x1080_sequence/42/', '/media/cine/First/Aff-wild2/masks/video85_sequence/57/', '/media/cine/First/Aff-wild2/masks/video52_sequence/301/', '/media/cine/First/Aff-wild2/masks/video86_3_sequence/2/', '/media/cine/First/Aff-wild2/masks/24-30-1920x1080-2_sequence/39/', '/media/cine/First/Aff-wild2/masks/74-25-1920x1080_sequence/48/', '/media/cine/First/Aff-wild2/masks/video15_sequence/311/', '/media/cine/First/Aff-wild2/masks/24-30-1920x1080-2_sequence/33/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/142/', '/media/cine/First/Aff-wild2/masks/video34_sequence/6/', '/media/cine/First/Aff-wild2/masks/video17_sequence/808/', '/media/cine/First/Aff-wild2/masks/97-29-1920x1080_sequence/194/', '/media/cine/First/Aff-wild2/masks/97-29-1920x1080_sequence/68/', '/media/cine/First/Aff-wild2/masks/video27_sequence/324/', '/media/cine/First/Aff-wild2/masks/video27_sequence/1016/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/226/', '/media/cine/First/Aff-wild2/masks/111-25-1920x1080_sequence/1/', '/media/cine/First/Aff-wild2/masks/video85_sequence/103/', '/media/cine/First/Aff-wild2/masks/5-60-1920x1080-4_sequence/61/', '/media/cine/First/Aff-wild2/masks/video15_sequence/82/', '/media/cine/First/Aff-wild2/masks/video59_sequence/5/', '/media/cine/First/Aff-wild2/masks/video14_sequence/228/', '/media/cine/First/Aff-wild2/masks/video7_sequence/1079/', '/media/cine/First/Aff-wild2/masks/90-30-1080x1920_sequence/68/', '/media/cine/First/Aff-wild2/masks/114-30-1280x720_sequence/10/', '/media/cine/First/Aff-wild2/masks/video27_sequence/174/', '/media/cine/First/Aff-wild2/masks/video39_sequence/127/', '/media/cine/First/Aff-wild2/masks/video27_sequence/1109/', '/media/cine/First/Aff-wild2/masks/video27_sequence/1495/', '/media/cine/First/Aff-wild2/masks/97-29-1920x1080_sequence/299/', '/media/cine/First/Aff-wild2/masks/video39_sequence/140/', '/media/cine/First/Aff-wild2/masks/video59_sequence/357/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/111/', '/media/cine/First/Aff-wild2/masks/87-25-1920x1080_sequence/22/', '/media/cine/First/Aff-wild2/masks/16-30-1920x1080_sequence/34/', '/media/cine/First/Aff-wild2/masks/video17_sequence/865/', '/media/cine/First/Aff-wild2/masks/24-30-1920x1080-2_sequence/53/', '/media/cine/First/Aff-wild2/masks/video69_sequence/717/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/404/', '/media/cine/First/Aff-wild2/masks/137-30-1920x1080_sequence/167/', '/media/cine/First/Aff-wild2/masks/68-24-1920x1080_sequence/73/', '/media/cine/First/Aff-wild2/masks/video15_sequence/219/', '/media/cine/First/Aff-wild2/masks/video42_sequence/302/', '/media/cine/First/Aff-wild2/masks/77-30-1280x720_sequence/14/', '/media/cine/First/Aff-wild2/masks/video14_sequence/111/', '/media/cine/First/Aff-wild2/masks/video73_sequence/427/', '/media/cine/First/Aff-wild2/masks/video17_sequence/796/', '/media/cine/First/Aff-wild2/masks/video76_sequence/33/', '/media/cine/First/Aff-wild2/masks/video27_sequence/505/', '/media/cine/First/Aff-wild2/masks/video52_sequence/94/', '/media/cine/First/Aff-wild2/masks/video52_sequence/144/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/174/', '/media/cine/First/Aff-wild2/masks/video24_sequence/148/', '/media/cine/First/Aff-wild2/masks/video25_sequence/89/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/98/', '/media/cine/First/Aff-wild2/masks/60-30-1920x1080_sequence/1/', '/media/cine/First/Aff-wild2/masks/90-30-1080x1920_sequence/48/', '/media/cine/First/Aff-wild2/masks/84-30-1920x1080_sequence/28/', '/media/cine/First/Aff-wild2/masks/video52_sequence/103/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/109/', '/media/cine/First/Aff-wild2/masks/16-30-1920x1080_sequence/189/', '/media/cine/First/Aff-wild2/masks/16-30-1920x1080_sequence/137/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/228/', '/media/cine/First/Aff-wild2/masks/97-29-1920x1080_sequence/341/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/23/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/232/', '/media/cine/First/Aff-wild2/masks/video17_sequence/600/', '/media/cine/First/Aff-wild2/masks/video52_sequence/197/', '/media/cine/First/Aff-wild2/masks/video24_sequence/164/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/129/', '/media/cine/First/Aff-wild2/masks/video82_sequence/71/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1057/', '/media/cine/First/Aff-wild2/masks/video52_sequence/201/', '/media/cine/First/Aff-wild2/masks/video13_sequence/357/', '/media/cine/First/Aff-wild2/masks/95-24-1920x1080_sequence/1/', '/media/cine/First/Aff-wild2/masks/74-25-1920x1080_sequence/27/', '/media/cine/First/Aff-wild2/masks/video64_sequence/3/', '/media/cine/First/Aff-wild2/masks/34-25-1920x1080_sequence/38/', '/media/cine/First/Aff-wild2/masks/video52_sequence/135/', '/media/cine/First/Aff-wild2/masks/60-30-1920x1080_sequence/31/', '/media/cine/First/Aff-wild2/masks/video82_sequence/163/', '/media/cine/First/Aff-wild2/masks/87-25-1920x1080_sequence/17/', '/media/cine/First/Aff-wild2/masks/video47_sequence/4/', '/media/cine/First/Aff-wild2/masks/video27_sequence/528/', '/media/cine/First/Aff-wild2/masks/video17_sequence/423/', '/media/cine/First/Aff-wild2/masks/23-24-1920x1080_sequence/48/', '/media/cine/First/Aff-wild2/masks/video73_sequence/239/', '/media/cine/First/Aff-wild2/masks/video17_sequence/569/', '/media/cine/First/Aff-wild2/masks/video52_sequence/305/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/135/', '/media/cine/First/Aff-wild2/masks/video85_sequence/80/', '/media/cine/First/Aff-wild2/masks/video52_sequence/230/', '/media/cine/First/Aff-wild2/masks/video69_sequence/786/', '/media/cine/First/Aff-wild2/masks/131-30-1920x1080_sequence/382/', '/media/cine/First/Aff-wild2/masks/video73_sequence/51/', '/media/cine/First/Aff-wild2/masks/video44_sequence/51/', '/media/cine/First/Aff-wild2/masks/54-30-1080x1920_sequence/42/', '/media/cine/First/Aff-wild2/masks/video27_sequence/60/', '/media/cine/First/Aff-wild2/masks/video27_sequence/394/', '/media/cine/First/Aff-wild2/masks/23-24-1920x1080_sequence/56/', '/media/cine/First/Aff-wild2/masks/83-24-1920x1080_sequence/564/', '/media/cine/First/Aff-wild2/masks/video82_sequence/368/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/186/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1412/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1685/', '/media/cine/First/Aff-wild2/masks/video40_sequence/43/', '/media/cine/First/Aff-wild2/masks/video17_sequence/891/', '/media/cine/First/Aff-wild2/masks/137-30-1920x1080_sequence/11/', '/media/cine/First/Aff-wild2/masks/video17_sequence/549/', '/media/cine/First/Aff-wild2/masks/video64_sequence/78/', '/media/cine/First/Aff-wild2/masks/68-24-1920x1080_sequence/161/', '/media/cine/First/Aff-wild2/masks/video27_sequence/881/', '/media/cine/First/Aff-wild2/masks/video40_sequence/116/', '/media/cine/First/Aff-wild2/masks/video24_sequence/52/', '/media/cine/First/Aff-wild2/masks/7-60-1920x1080_sequence/109/', '/media/cine/First/Aff-wild2/masks/video44_sequence/18/', '/media/cine/First/Aff-wild2/masks/34-25-1920x1080_sequence/58/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/299/', '/media/cine/First/Aff-wild2/masks/video85_sequence/129/', '/media/cine/First/Aff-wild2/masks/134-30-1280x720_sequence/5/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/8/', '/media/cine/First/Aff-wild2/masks/video69_sequence/139/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/157/', '/media/cine/First/Aff-wild2/masks/video17_sequence/505/', '/media/cine/First/Aff-wild2/masks/video52_sequence/308/', '/media/cine/First/Aff-wild2/masks/14-30-1920x1080_sequence/197/', '/media/cine/First/Aff-wild2/masks/14-30-1920x1080_sequence/261/', '/media/cine/First/Aff-wild2/masks/video17_sequence/824/', '/media/cine/First/Aff-wild2/masks/video27_sequence/1282/', '/media/cine/First/Aff-wild2/masks/video86_1_sequence/90/', '/media/cine/First/Aff-wild2/masks/101-30-1080x1920_sequence/427/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/313/', '/media/cine/First/Aff-wild2/masks/video82_sequence/173/', '/media/cine/First/Aff-wild2/masks/16-30-1920x1080_sequence/22/', '/media/cine/First/Aff-wild2/masks/video69_sequence/1301/', '/media/cine/First/Aff-wild2/masks/68-24-1920x1080_sequence/180/', '/media/cine/First/Aff-wild2/masks/video27_sequence/16/', '/media/cine/First/Aff-wild2/masks/5-60-1920x1080-1_sequence/127/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/226/', '/media/cine/First/Aff-wild2/masks/video69_sequence/1265/', '/media/cine/First/Aff-wild2/masks/video17_sequence/347/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/235/', '/media/cine/First/Aff-wild2/masks/video24_sequence/37/', '/media/cine/First/Aff-wild2/masks/video27_sequence/641/', '/media/cine/First/Aff-wild2/masks/100-29-1080x1920_sequence/80/', '/media/cine/First/Aff-wild2/masks/video44_sequence/66/', '/media/cine/First/Aff-wild2/masks/video86_1_sequence/107/', '/media/cine/First/Aff-wild2/masks/70-30-720x1280_sequence/8/', '/media/cine/First/Aff-wild2/masks/34-25-1920x1080_sequence/67/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/136/', '/media/cine/First/Aff-wild2/masks/24-30-1920x1080-2_sequence/29/', '/media/cine/First/Aff-wild2/masks/136-30-1920x1080_sequence/2166/', '/media/cine/First/Aff-wild2/masks/video85_sequence/110/', '/media/cine/First/Aff-wild2/masks/92-24-1920x1080_sequence/24/', '/media/cine/First/Aff-wild2/masks/12-24-1920x1080_sequence/154/', '/media/cine/First/Aff-wild2/masks/video17_sequence/594/', '/media/cine/First/Aff-wild2/masks/video17_sequence/94/', '/media/cine/First/Aff-wild2/masks/video27_sequence/705/', '/media/cine/First/Aff-wild2/masks/video24_sequence/21/', '/media/cine/First/Aff-wild2/masks/7-60-1920x1080_sequence/351/', '/media/cine/First/Aff-wild2/masks/video17_sequence/54/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1410/', '/media/cine/First/Aff-wild2/masks/7-60-1920x1080_sequence/165/', '/media/cine/First/Aff-wild2/masks/66-25-1080x1920_sequence/123/', '/media/cine/First/Aff-wild2/masks/5-60-1920x1080-2_sequence/33/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/380/', '/media/cine/First/Aff-wild2/masks/video78_sequence/10/', '/media/cine/First/Aff-wild2/masks/83-24-1920x1080_sequence/534/', '/media/cine/First/Aff-wild2/masks/video40_sequence/67/', '/media/cine/First/Aff-wild2/masks/video73_sequence/29/', '/media/cine/First/Aff-wild2/masks/video96_sequence/23/', '/media/cine/First/Aff-wild2/masks/video52_sequence/49/', '/media/cine/First/Aff-wild2/masks/video27_sequence/1013/', '/media/cine/First/Aff-wild2/masks/136-30-1920x1080_sequence/18/', '/media/cine/First/Aff-wild2/masks/137-30-1920x1080_sequence/304/', '/media/cine/First/Aff-wild2/masks/16-30-1920x1080_sequence/186/', '/media/cine/First/Aff-wild2/masks/video17_sequence/587/', '/media/cine/First/Aff-wild2/masks/video52_sequence/215/', '/media/cine/First/Aff-wild2/masks/video59_sequence/347/', '/media/cine/First/Aff-wild2/masks/video76_sequence/96/', '/media/cine/First/Aff-wild2/masks/video33_sequence/518/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/255/', '/media/cine/First/Aff-wild2/masks/video40_sequence/40/', '/media/cine/First/Aff-wild2/masks/video37_sequence/20/', '/media/cine/First/Aff-wild2/masks/video51_sequence/129/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/251/', '/media/cine/First/Aff-wild2/masks/video85_sequence/29/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/359/', '/media/cine/First/Aff-wild2/masks/video17_sequence/903/', '/media/cine/First/Aff-wild2/masks/video85_sequence/144/', '/media/cine/First/Aff-wild2/masks/video14_sequence/222/', '/media/cine/First/Aff-wild2/masks/66-25-1080x1920_sequence/38/', '/media/cine/First/Aff-wild2/masks/video44_sequence/56/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/339/', '/media/cine/First/Aff-wild2/masks/video17_sequence/136/', '/media/cine/First/Aff-wild2/masks/34-25-1920x1080_sequence/11/', '/media/cine/First/Aff-wild2/masks/video42_sequence/261/', '/media/cine/First/Aff-wild2/masks/video69_sequence/776/', '/media/cine/First/Aff-wild2/masks/video69_sequence/142/', '/media/cine/First/Aff-wild2/masks/video27_sequence/279/', '/media/cine/First/Aff-wild2/masks/video42_sequence/190/', '/media/cine/First/Aff-wild2/masks/32-60-1920x1080_sequence/278/', '/media/cine/First/Aff-wild2/masks/137-30-1920x1080_sequence/209/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/162/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/583/', '/media/cine/First/Aff-wild2/masks/video52_sequence/177/', '/media/cine/First/Aff-wild2/masks/video42_sequence/131/', '/media/cine/First/Aff-wild2/masks/video82_sequence/199/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/43/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/144/', '/media/cine/First/Aff-wild2/masks/137-30-1920x1080_sequence/270/', '/media/cine/First/Aff-wild2/masks/77-30-1280x720_sequence/8/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/464/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/165/', '/media/cine/First/Aff-wild2/masks/66-25-1080x1920_sequence/35/', '/media/cine/First/Aff-wild2/masks/video95_sequence/360/', '/media/cine/First/Aff-wild2/masks/video82_sequence/395/', '/media/cine/First/Aff-wild2/masks/video27_sequence/536/', '/media/cine/First/Aff-wild2/masks/video17_sequence/793/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/122/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/50/', '/media/cine/First/Aff-wild2/masks/video17_sequence/427/', '/media/cine/First/Aff-wild2/masks/video82_sequence/161/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/91/', '/media/cine/First/Aff-wild2/masks/video42_sequence/217/', '/media/cine/First/Aff-wild2/masks/34-25-1920x1080_sequence/15/', '/media/cine/First/Aff-wild2/masks/16-30-1920x1080_sequence/250/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/141/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/173/', '/media/cine/First/Aff-wild2/masks/video44_sequence/46/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/20/', '/media/cine/First/Aff-wild2/masks/video59_sequence/195/', '/media/cine/First/Aff-wild2/masks/video27_sequence/260/', '/media/cine/First/Aff-wild2/masks/video6_sequence/49/', '/media/cine/First/Aff-wild2/masks/video59_sequence/129/', '/media/cine/First/Aff-wild2/masks/5-60-1920x1080-2_sequence/78/', '/media/cine/First/Aff-wild2/masks/video27_sequence/218/', '/media/cine/First/Aff-wild2/masks/video52_sequence/109/', '/media/cine/First/Aff-wild2/masks/video82_sequence/722/', '/media/cine/First/Aff-wild2/masks/24-30-1920x1080-1_sequence/21/', '/media/cine/First/Aff-wild2/masks/video13_sequence/385/', '/media/cine/First/Aff-wild2/masks/68-24-1920x1080_sequence/51/', '/media/cine/First/Aff-wild2/masks/video52_sequence/150/', '/media/cine/First/Aff-wild2/masks/video15_sequence/326/', '/media/cine/First/Aff-wild2/masks/124-30-720x1280_sequence/354/', '/media/cine/First/Aff-wild2/masks/70-30-720x1280_sequence/25/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/118/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/247/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/358/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1421/', '/media/cine/First/Aff-wild2/masks/video15_sequence/173/', '/media/cine/First/Aff-wild2/masks/video85_sequence/81/', '/media/cine/First/Aff-wild2/masks/video17_sequence/557/', '/media/cine/First/Aff-wild2/masks/83-24-1920x1080_sequence/176/', '/media/cine/First/Aff-wild2/masks/video67_sequence/55/', '/media/cine/First/Aff-wild2/masks/74-25-1920x1080_sequence/42/', '/media/cine/First/Aff-wild2/masks/video27_sequence/55/', '/media/cine/First/Aff-wild2/masks/54-30-1080x1920_sequence/27/', '/media/cine/First/Aff-wild2/masks/70-30-720x1280_sequence/58/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1190/', '/media/cine/First/Aff-wild2/masks/video17_sequence/582/', '/media/cine/First/Aff-wild2/masks/video82_sequence/385/', '/media/cine/First/Aff-wild2/masks/video59_sequence/111/', '/media/cine/First/Aff-wild2/masks/video59_sequence/289/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/29/', '/media/cine/First/Aff-wild2/masks/video39_sequence/80/', '/media/cine/First/Aff-wild2/masks/video24_sequence/149/', '/media/cine/First/Aff-wild2/masks/video69_sequence/1252/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/110/', '/media/cine/First/Aff-wild2/masks/video85_sequence/50/', '/media/cine/First/Aff-wild2/masks/131-30-1920x1080_sequence/359/', '/media/cine/First/Aff-wild2/masks/video25_sequence/205/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1136/', '/media/cine/First/Aff-wild2/masks/video69_sequence/473/', '/media/cine/First/Aff-wild2/masks/video94_sequence/14/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/109/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/59/', '/media/cine/First/Aff-wild2/masks/83-24-1920x1080_sequence/58/', '/media/cine/First/Aff-wild2/masks/video25_sequence/10/', '/media/cine/First/Aff-wild2/masks/video17_sequence/894/', '/media/cine/First/Aff-wild2/masks/video85_sequence/140/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/279/', '/media/cine/First/Aff-wild2/masks/90-30-1080x1920_sequence/269/', '/media/cine/First/Aff-wild2/masks/23-24-1920x1080_sequence/34/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/22/', '/media/cine/First/Aff-wild2/masks/137-30-1920x1080_sequence/61/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/112/', '/media/cine/First/Aff-wild2/masks/video82_sequence/405/', '/media/cine/First/Aff-wild2/masks/68-24-1920x1080_sequence/193/', '/media/cine/First/Aff-wild2/masks/video13_sequence/129/', '/media/cine/First/Aff-wild2/masks/video14_sequence/174/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/172/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/258/', '/media/cine/First/Aff-wild2/masks/video42_sequence/98/', '/media/cine/First/Aff-wild2/masks/97-29-1920x1080_sequence/266/', '/media/cine/First/Aff-wild2/masks/70-30-720x1280_sequence/83/', '/media/cine/First/Aff-wild2/masks/video59_sequence/86/', '/media/cine/First/Aff-wild2/masks/video42_sequence/70/', '/media/cine/First/Aff-wild2/masks/137-30-1920x1080_sequence/4/', '/media/cine/First/Aff-wild2/masks/video27_sequence/861/', '/media/cine/First/Aff-wild2/masks/70-30-720x1280_sequence/60/', '/media/cine/First/Aff-wild2/masks/video24_sequence/75/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/14/', '/media/cine/First/Aff-wild2/masks/68-24-1920x1080_sequence/28/', '/media/cine/First/Aff-wild2/masks/video76_sequence/48/', '/media/cine/First/Aff-wild2/masks/34-25-1920x1080_sequence/37/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/123/', '/media/cine/First/Aff-wild2/masks/video82_sequence/7/', '/media/cine/First/Aff-wild2/masks/137-30-1920x1080_sequence/196/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/239/', '/media/cine/First/Aff-wild2/masks/video13_sequence/416/', '/media/cine/First/Aff-wild2/masks/video17_sequence/802/', '/media/cine/First/Aff-wild2/masks/84-30-1920x1080_sequence/5/', '/media/cine/First/Aff-wild2/masks/137-30-1920x1080_sequence/383/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/455/', '/media/cine/First/Aff-wild2/masks/video51_sequence/31/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1731/', '/media/cine/First/Aff-wild2/masks/video52_sequence/60/', '/media/cine/First/Aff-wild2/masks/video51_sequence/115/', '/media/cine/First/Aff-wild2/masks/video86_1_sequence/80/', '/media/cine/First/Aff-wild2/masks/74-25-1920x1080_sequence/58/', '/media/cine/First/Aff-wild2/masks/video64_sequence/4/', '/media/cine/First/Aff-wild2/masks/24-30-1920x1080-2_sequence/37/', '/media/cine/First/Aff-wild2/masks/74-25-1920x1080_sequence/39/', '/media/cine/First/Aff-wild2/masks/video44_sequence/110/', '/media/cine/First/Aff-wild2/masks/video69_sequence/55/', '/media/cine/First/Aff-wild2/masks/video40_sequence/125/', '/media/cine/First/Aff-wild2/masks/video69_sequence/1282/', '/media/cine/First/Aff-wild2/masks/video52_sequence/117/', '/media/cine/First/Aff-wild2/masks/video42_sequence/298/', '/media/cine/First/Aff-wild2/masks/87-25-1920x1080_sequence/11/', '/media/cine/First/Aff-wild2/masks/137-30-1920x1080_sequence/344/', '/media/cine/First/Aff-wild2/masks/100-29-1080x1920_sequence/83/', '/media/cine/First/Aff-wild2/masks/video82_sequence/168/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/282/', '/media/cine/First/Aff-wild2/masks/66-25-1080x1920_sequence/9/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/71/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/152/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/105/', '/media/cine/First/Aff-wild2/masks/34-25-1920x1080_sequence/79/', '/media/cine/First/Aff-wild2/masks/49-30-1280x720_sequence/40/', '/media/cine/First/Aff-wild2/masks/video78_sequence/13/', '/media/cine/First/Aff-wild2/masks/68-24-1920x1080_sequence/178/', '/media/cine/First/Aff-wild2/masks/video42_sequence/69/', '/media/cine/First/Aff-wild2/masks/video34_sequence/59/', '/media/cine/First/Aff-wild2/masks/111-25-1920x1080_sequence/3/', '/media/cine/First/Aff-wild2/masks/video51_sequence/112/', '/media/cine/First/Aff-wild2/masks/video40_sequence/110/', '/media/cine/First/Aff-wild2/masks/video27_sequence/53/', '/media/cine/First/Aff-wild2/masks/video40_sequence/97/', '/media/cine/First/Aff-wild2/masks/video64_sequence/59/', '/media/cine/First/Aff-wild2/masks/90-30-1080x1920_sequence/70/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/329/', '/media/cine/First/Aff-wild2/masks/video69_sequence/715/', '/media/cine/First/Aff-wild2/masks/video14_sequence/86/', '/media/cine/First/Aff-wild2/masks/video27_sequence/20/', '/media/cine/First/Aff-wild2/masks/video27_sequence/1389/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/356/', '/media/cine/First/Aff-wild2/masks/video52_sequence/222/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/366/', '/media/cine/First/Aff-wild2/masks/34-25-1920x1080_sequence/4/', '/media/cine/First/Aff-wild2/masks/77-30-1280x720_sequence/21/', '/media/cine/First/Aff-wild2/masks/24-30-1920x1080-1_sequence/19/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/234/', '/media/cine/First/Aff-wild2/masks/video52_sequence/88/', '/media/cine/First/Aff-wild2/masks/video69_sequence/1309/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1716/', '/media/cine/First/Aff-wild2/masks/video59_sequence/344/', '/media/cine/First/Aff-wild2/masks/video40_sequence/31/', '/media/cine/First/Aff-wild2/masks/video15_sequence/104/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/83/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/285/', '/media/cine/First/Aff-wild2/masks/7-60-1920x1080_sequence/490/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/110/', '/media/cine/First/Aff-wild2/masks/video64_sequence/69/', '/media/cine/First/Aff-wild2/masks/24-30-1920x1080-2_sequence/36/', '/media/cine/First/Aff-wild2/masks/video34_sequence/19/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/220/', '/media/cine/First/Aff-wild2/masks/video59_sequence/318/', '/media/cine/First/Aff-wild2/masks/24-30-1920x1080-2_sequence/112/', '/media/cine/First/Aff-wild2/masks/video17_sequence/750/', '/media/cine/First/Aff-wild2/masks/66-25-1080x1920_sequence/46/', '/media/cine/First/Aff-wild2/masks/74-25-1920x1080_sequence/20/', '/media/cine/First/Aff-wild2/masks/video40_sequence/61/', '/media/cine/First/Aff-wild2/masks/video44_sequence/40/', '/media/cine/First/Aff-wild2/masks/101-30-1080x1920_sequence/126/', '/media/cine/First/Aff-wild2/masks/34-25-1920x1080_sequence/65/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/18/', '/media/cine/First/Aff-wild2/masks/video42_sequence/201/', '/media/cine/First/Aff-wild2/masks/100-29-1080x1920_sequence/112/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/73/', '/media/cine/First/Aff-wild2/masks/66-25-1080x1920_sequence/125/', '/media/cine/First/Aff-wild2/masks/video85_sequence/48/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/104/', '/media/cine/First/Aff-wild2/masks/34-25-1920x1080_sequence/1/', '/media/cine/First/Aff-wild2/masks/90-30-1080x1920_sequence/263/', '/media/cine/First/Aff-wild2/masks/50-30-1920x1080_sequence/84/', '/media/cine/First/Aff-wild2/masks/74-25-1920x1080_sequence/17/', '/media/cine/First/Aff-wild2/masks/77-30-1280x720_sequence/9/', '/media/cine/First/Aff-wild2/masks/12-24-1920x1080_sequence/12/', '/media/cine/First/Aff-wild2/masks/video85_sequence/101/', '/media/cine/First/Aff-wild2/masks/136-30-1920x1080_sequence/2172/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/167/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/446/', '/media/cine/First/Aff-wild2/masks/video27_sequence/860/', '/media/cine/First/Aff-wild2/masks/23-24-1920x1080_sequence/11/', '/media/cine/First/Aff-wild2/masks/video42_sequence/77/', '/media/cine/First/Aff-wild2/masks/video27_sequence/444/', '/media/cine/First/Aff-wild2/masks/video27_sequence/987/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/257/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1083/', '/media/cine/First/Aff-wild2/masks/video69_sequence/42/', '/media/cine/First/Aff-wild2/masks/100-29-1080x1920_sequence/105/', '/media/cine/First/Aff-wild2/masks/video24_sequence/29/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1198/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/282/', '/media/cine/First/Aff-wild2/masks/7-60-1920x1080_sequence/256/', '/media/cine/First/Aff-wild2/masks/video86_2_sequence/6/', '/media/cine/First/Aff-wild2/masks/video44_sequence/71/', '/media/cine/First/Aff-wild2/masks/video73_sequence/82/', '/media/cine/First/Aff-wild2/masks/video82_sequence/424/', '/media/cine/First/Aff-wild2/masks/video52_sequence/198/', '/media/cine/First/Aff-wild2/masks/video17_sequence/28/', '/media/cine/First/Aff-wild2/masks/7-60-1920x1080_sequence/114/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1657/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/173/', '/media/cine/First/Aff-wild2/masks/68-24-1920x1080_sequence/70/', '/media/cine/First/Aff-wild2/masks/video15_sequence/142/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/89/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/2/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/9/', '/media/cine/First/Aff-wild2/masks/video13_sequence/20/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/278/', '/media/cine/First/Aff-wild2/masks/video86_1_sequence/78/', '/media/cine/First/Aff-wild2/masks/video89_sequence/177/', '/media/cine/First/Aff-wild2/masks/97-29-1920x1080_sequence/67/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/61/', '/media/cine/First/Aff-wild2/masks/video82_sequence/28/', '/media/cine/First/Aff-wild2/masks/video15_sequence/175/', '/media/cine/First/Aff-wild2/masks/84-30-1920x1080_sequence/19/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/15/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/252/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/628/', '/media/cine/First/Aff-wild2/masks/7-60-1920x1080_sequence/485/', '/media/cine/First/Aff-wild2/masks/video82_sequence/17/', '/media/cine/First/Aff-wild2/masks/66-25-1080x1920_sequence/99/', '/media/cine/First/Aff-wild2/masks/7-60-1920x1080_sequence/463/', '/media/cine/First/Aff-wild2/masks/video86_1_sequence/95/', '/media/cine/First/Aff-wild2/masks/14-30-1920x1080_sequence/36/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/95/', '/media/cine/First/Aff-wild2/masks/5-60-1920x1080-2_sequence/76/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/19/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1703/', '/media/cine/First/Aff-wild2/masks/video24_sequence/31/', '/media/cine/First/Aff-wild2/masks/92-24-1920x1080_sequence/14/', '/media/cine/First/Aff-wild2/masks/16-30-1920x1080_sequence/210/', '/media/cine/First/Aff-wild2/masks/34-25-1920x1080_sequence/16/', '/media/cine/First/Aff-wild2/masks/68-24-1920x1080_sequence/49/', '/media/cine/First/Aff-wild2/masks/video27_sequence/1015/', '/media/cine/First/Aff-wild2/masks/97-29-1920x1080_sequence/241/', '/media/cine/First/Aff-wild2/masks/video40_sequence/44/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/25/', '/media/cine/First/Aff-wild2/masks/101-30-1080x1920_sequence/123/', '/media/cine/First/Aff-wild2/masks/video82_sequence/641/', '/media/cine/First/Aff-wild2/masks/video2_sequence/1/', '/media/cine/First/Aff-wild2/masks/video85_sequence/75/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1633/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/29/', '/media/cine/First/Aff-wild2/masks/video82_sequence/172/', '/media/cine/First/Aff-wild2/masks/video59_sequence/76/', '/media/cine/First/Aff-wild2/masks/92-24-1920x1080_sequence/11/', '/media/cine/First/Aff-wild2/masks/68-24-1920x1080_sequence/103/', '/media/cine/First/Aff-wild2/masks/video52_sequence/151/', '/media/cine/First/Aff-wild2/masks/34-25-1920x1080_sequence/78/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/124/', '/media/cine/First/Aff-wild2/masks/video17_sequence/278/', '/media/cine/First/Aff-wild2/masks/97-29-1920x1080_sequence/187/', '/media/cine/First/Aff-wild2/masks/101-30-1080x1920_sequence/6/', '/media/cine/First/Aff-wild2/masks/video33_sequence/510/', '/media/cine/First/Aff-wild2/masks/video27_sequence/35/', '/media/cine/First/Aff-wild2/masks/video85_sequence/47/', '/media/cine/First/Aff-wild2/masks/34-25-1920x1080_sequence/5/', '/media/cine/First/Aff-wild2/masks/122-60-1920x1080-4_sequence/1/', '/media/cine/First/Aff-wild2/masks/7-60-1920x1080_sequence/456/', '/media/cine/First/Aff-wild2/masks/60-30-1920x1080_sequence/47/', '/media/cine/First/Aff-wild2/masks/video40_sequence/9/', '/media/cine/First/Aff-wild2/masks/video15_sequence/22/', '/media/cine/First/Aff-wild2/masks/video24_sequence/92/', '/media/cine/First/Aff-wild2/masks/100-29-1080x1920_sequence/3/', '/media/cine/First/Aff-wild2/masks/video34_sequence/53/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/460/', '/media/cine/First/Aff-wild2/masks/70-30-720x1280_sequence/24/', '/media/cine/First/Aff-wild2/masks/video37_sequence/3/', '/media/cine/First/Aff-wild2/masks/101-30-1080x1920_sequence/236/', '/media/cine/First/Aff-wild2/masks/14-30-1920x1080_sequence/200/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/322/', '/media/cine/First/Aff-wild2/masks/83-24-1920x1080_sequence/592/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/254/', '/media/cine/First/Aff-wild2/masks/122-60-1920x1080-2_sequence/64/', '/media/cine/First/Aff-wild2/masks/87-25-1920x1080_sequence/12/', '/media/cine/First/Aff-wild2/masks/video42_sequence/3/', '/media/cine/First/Aff-wild2/masks/49-30-1280x720_sequence/84/', '/media/cine/First/Aff-wild2/masks/137-30-1920x1080_sequence/28/', '/media/cine/First/Aff-wild2/masks/7-60-1920x1080_sequence/90/', '/media/cine/First/Aff-wild2/masks/video15_sequence/147/', '/media/cine/First/Aff-wild2/masks/video73_sequence/256/', '/media/cine/First/Aff-wild2/masks/video76_sequence/5/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/87/', '/media/cine/First/Aff-wild2/masks/video76_sequence/58/', '/media/cine/First/Aff-wild2/masks/video17_sequence/292/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/249/', '/media/cine/First/Aff-wild2/masks/video69_sequence/1187/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/10/', '/media/cine/First/Aff-wild2/masks/90-30-1080x1920_sequence/47/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/243/', '/media/cine/First/Aff-wild2/masks/video85_sequence/72/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/195/', '/media/cine/First/Aff-wild2/masks/137-30-1920x1080_sequence/351/', '/media/cine/First/Aff-wild2/masks/video47_sequence/8/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/315/', '/media/cine/First/Aff-wild2/masks/131-30-1920x1080_sequence/402/', '/media/cine/First/Aff-wild2/masks/video16_sequence/13/', '/media/cine/First/Aff-wild2/masks/95-24-1920x1080_sequence/43/', '/media/cine/First/Aff-wild2/masks/video13_sequence/399/', '/media/cine/First/Aff-wild2/masks/video39_sequence/79/', '/media/cine/First/Aff-wild2/masks/60-30-1920x1080_sequence/54/', '/media/cine/First/Aff-wild2/masks/video22_sequence/51/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/183/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/143/', '/media/cine/First/Aff-wild2/masks/68-24-1920x1080_sequence/26/', '/media/cine/First/Aff-wild2/masks/video59_sequence/130/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/641/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/13/', '/media/cine/First/Aff-wild2/masks/video40_sequence/98/', '/media/cine/First/Aff-wild2/masks/90-30-1080x1920_sequence/271/', '/media/cine/First/Aff-wild2/masks/video69_sequence/79/', '/media/cine/First/Aff-wild2/masks/14-30-1920x1080_sequence/262/', '/media/cine/First/Aff-wild2/masks/video67_sequence/91/', '/media/cine/First/Aff-wild2/masks/video44_sequence/107/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/675/', '/media/cine/First/Aff-wild2/masks/60-30-1920x1080_sequence/91/', '/media/cine/First/Aff-wild2/masks/136-30-1920x1080_sequence/2157/', '/media/cine/First/Aff-wild2/masks/4-30-1920x1080_sequence/121/', '/media/cine/First/Aff-wild2/masks/video17_sequence/586/', '/media/cine/First/Aff-wild2/masks/16-30-1920x1080_sequence/407/', '/media/cine/First/Aff-wild2/masks/92-24-1920x1080_sequence/5/', '/media/cine/First/Aff-wild2/masks/23-24-1920x1080_sequence/74/', '/media/cine/First/Aff-wild2/masks/video16_sequence/97/', '/media/cine/First/Aff-wild2/masks/video64_sequence/138/', '/media/cine/First/Aff-wild2/masks/video13_sequence/403/', '/media/cine/First/Aff-wild2/masks/101-30-1080x1920_sequence/108/', '/media/cine/First/Aff-wild2/masks/74-25-1920x1080_sequence/50/', '/media/cine/First/Aff-wild2/masks/video52_sequence/246/', '/media/cine/First/Aff-wild2/masks/video82_sequence/190/', '/media/cine/First/Aff-wild2/masks/video69_sequence/12/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/503/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1139/', '/media/cine/First/Aff-wild2/masks/video95_sequence/234/', '/media/cine/First/Aff-wild2/masks/video82_sequence/16/', '/media/cine/First/Aff-wild2/masks/video95_sequence/147/', '/media/cine/First/Aff-wild2/masks/video27_sequence/332/', '/media/cine/First/Aff-wild2/masks/68-24-1920x1080_sequence/181/', '/media/cine/First/Aff-wild2/masks/131-30-1920x1080_sequence/405/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/88/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/273/', '/media/cine/First/Aff-wild2/masks/video13_sequence/117/', '/media/cine/First/Aff-wild2/masks/video76_sequence/92/', '/media/cine/First/Aff-wild2/masks/video85_sequence/58/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1034/', '/media/cine/First/Aff-wild2/masks/video23_sequence/16/', '/media/cine/First/Aff-wild2/masks/137-30-1920x1080_sequence/285/', '/media/cine/First/Aff-wild2/masks/16-30-1920x1080_sequence/207/', '/media/cine/First/Aff-wild2/masks/137-30-1920x1080_sequence/309/', '/media/cine/First/Aff-wild2/masks/video82_sequence/386/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1722/', '/media/cine/First/Aff-wild2/masks/12-24-1920x1080_sequence/1/', '/media/cine/First/Aff-wild2/masks/97-29-1920x1080_sequence/26/', '/media/cine/First/Aff-wild2/masks/video13_sequence/44/', '/media/cine/First/Aff-wild2/masks/video52_sequence/90/', '/media/cine/First/Aff-wild2/masks/video82_sequence/588/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/209/', '/media/cine/First/Aff-wild2/masks/5-60-1920x1080-3_sequence/40/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/90/', '/media/cine/First/Aff-wild2/masks/video82_sequence/723/', '/media/cine/First/Aff-wild2/masks/video73_sequence/295/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/87/', '/media/cine/First/Aff-wild2/masks/74-25-1920x1080_sequence/57/', '/media/cine/First/Aff-wild2/masks/video14_sequence/41/', '/media/cine/First/Aff-wild2/masks/video51_sequence/99/', '/media/cine/First/Aff-wild2/masks/68-24-1920x1080_sequence/34/', '/media/cine/First/Aff-wild2/masks/video13_sequence/154/', '/media/cine/First/Aff-wild2/masks/video52_sequence/282/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/180/', '/media/cine/First/Aff-wild2/masks/video17_sequence/981/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/70/', '/media/cine/First/Aff-wild2/masks/16-30-1920x1080_sequence/21/', '/media/cine/First/Aff-wild2/masks/90-30-1080x1920_sequence/57/', '/media/cine/First/Aff-wild2/masks/video64_sequence/77/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1521/', '/media/cine/First/Aff-wild2/masks/92-24-1920x1080_sequence/16/', '/media/cine/First/Aff-wild2/masks/74-25-1920x1080_sequence/7/', '/media/cine/First/Aff-wild2/masks/34-25-1920x1080_sequence/64/', '/media/cine/First/Aff-wild2/masks/video27_sequence/948/', '/media/cine/First/Aff-wild2/masks/video13_sequence/199/', '/media/cine/First/Aff-wild2/masks/34-25-1920x1080_sequence/75/', '/media/cine/First/Aff-wild2/masks/90-30-1080x1920_sequence/225/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1075/', '/media/cine/First/Aff-wild2/masks/video95_sequence/355/', '/media/cine/First/Aff-wild2/masks/7-60-1920x1080_sequence/266/', '/media/cine/First/Aff-wild2/masks/video85_sequence/71/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/341/', '/media/cine/First/Aff-wild2/masks/12-24-1920x1080_sequence/22/', '/media/cine/First/Aff-wild2/masks/84-30-1920x1080_sequence/36/', '/media/cine/First/Aff-wild2/masks/video86_1_sequence/17/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/21/', '/media/cine/First/Aff-wild2/masks/video85_sequence/66/', '/media/cine/First/Aff-wild2/masks/video64_sequence/142/', '/media/cine/First/Aff-wild2/masks/68-24-1920x1080_sequence/188/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/168/', '/media/cine/First/Aff-wild2/masks/114-30-1280x720_sequence/2/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/290/', '/media/cine/First/Aff-wild2/masks/5-60-1920x1080-1_sequence/203/', '/media/cine/First/Aff-wild2/masks/video17_sequence/739/', '/media/cine/First/Aff-wild2/masks/35-30-1920x1080_sequence/248/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/278/', '/media/cine/First/Aff-wild2/masks/video82_sequence/547/', '/media/cine/First/Aff-wild2/masks/123-25-1920x1080_sequence/287/', '/media/cine/First/Aff-wild2/masks/video42_sequence/23/', '/media/cine/First/Aff-wild2/masks/9-15-1920x1080_sequence/241/', '/media/cine/First/Aff-wild2/masks/101-30-1080x1920_sequence/105/', '/media/cine/First/Aff-wild2/masks/video85_sequence/128/', '/media/cine/First/Aff-wild2/masks/24-30-1920x1080-2_sequence/41/', '/media/cine/First/Aff-wild2/masks/video27_sequence/622/', '/media/cine/First/Aff-wild2/masks/23-24-1920x1080_sequence/71/', '/media/cine/First/Aff-wild2/masks/video14_sequence/212/', '/media/cine/First/Aff-wild2/masks/video17_sequence/1394/', '/media/cine/First/Aff-wild2/masks/77-30-1280x720_sequence/15/', '/media/cine/First/Aff-wild2/masks/video69_sequence/1297/', '/media/cine/First/Aff-wild2/masks/97-29-1920x1080_sequence/238/']
        self.windowsize = 3

    # def shuffle(self):
    #     random.shuffle(self.audioList)

    def __len__(self):
        return len(self.masksList)

    def __getitem__(self, idx):
        # images_224_lists = [];
        images_list = [];
        kpt_list = [];
        dense_kpt_list = [];
        mask_list = [];
        # identity_list= []
        # name = os.path.splitext(os.path.split()[-1])[0]
        # name = os.path.splitext(os.path.split(self.allkptFiles[idx])[-1])[0]
        mask_paths = self.masksList[idx]
        # audio_feature = np.load(audio_path, allow_pickle=True)
        allImagePath = sorted(glob(os.path.join(mask_paths.replace('masks', 'images'),'*.*')))
        if len((allImagePath)) < self.windowsize:
            print("small...", mask_paths)

        if self.windowsize % 2 == 0:
            half1 = half2 = int(self.windowsize / 2)
        else:
            half1 = int(self.windowsize /2)
            half2 = int(self.windowsize /2)+1
        tempId = random.randint(half1, len(allImagePath)-half2)
        # tempId = 24
        imagesName = []
        audio_feature_list = []
        if 'Aff-wild2' in mask_paths:
            mk = 2
        else:
            mk = 1
        for k in range(tempId-half1, tempId+half2):
            image_path = allImagePath[k]
            imagesName.append(image_path)
            # if os.path.exists(audio_path.replace('audio', 'images').replace('.npy', '.jpg')):
            #     image_path = audio_path.replace('audio', 'images').replace('.npy', '.jpg')
            # else:
            #     image_path = audio_path.replace('masks', 'images').replace('.npy', '.png')
            # if k == tempId:
            #     identity_path =image_path.replace('images', 'identity').replace('.png', '.npy').replace('.jpg', '.npy')
            #     idName = os.path.splitext(os.path.split(identity_path)[-1])[0]
            # identity_path = image_path.replace('images', 'identity').replace('.png', '.npy').replace('.jpg', '.npy')
            # idName = os.path.splitext(os.path.split(identity_path)[-1])[0]

            kpt_path = image_path.replace('images','kpts').replace('.png', '.npy').replace('.jpg', '.npy')
            kpt_path_mp = image_path.replace('images', 'kpts_dense').replace('.png', '.npy').replace('.jpg', '.npy')
            seg_path = image_path.replace('images', 'masks').replace('.png', '.npy').replace('.jpg', '.npy')
            # audio_path = os.path.split(seg_path.replace('images', 'audio'))[0]

            # dense_lmks =  np.load(kpt_path_mp)[:, :2]
            lmks = np.load(kpt_path)
            dense_lmks = np.load(kpt_path_mp)
            # if not os.path.exists(image_path) or not os.path.exists(kpt_path) or not os.path.exists(kpt_path_mp) or not os.path.exists(seg_path):
            #     print(not os.path.exists(image_path) or not os.path.exists(kpt_path) or not os.path.exists(kpt_path_mp) or not os.path.exists(seg_path))
            if not os.path.getsize(image_path) or not os.path.getsize(kpt_path) or not os.path.getsize(kpt_path_mp) or not os.path.getsize(seg_path):
                print(os.path.getsize(image_path),image_path)
                print(os.path.getsize(kpt_path),kpt_path)
                print(os.path.getsize(kpt_path_mp),kpt_path_mp)
                print(os.path.getsize(seg_path),seg_path)
            image = imread(image_path) / 255.
            mask = self.load_mask(seg_path, image.shape[0], image.shape[1])

            # images_224_lists.append(cv2.resize(image, (224, 224)).transpose(2, 0, 1))
            if image.shape[1] == 224:
                images_list.append(image.transpose(2, 0, 1))
                kpt_list.append(lmks)
                dense_kpt_list.append(dense_lmks[self.mediapipe_idx, :])
                mask_list.append(mask.transpose(2, 0, 1))
            else:
                kpt_list.append(lmks)
                dense_kpt_list.append(dense_lmks[self.mediapipe_idx, :])
                mask_list.append(np.resize(mask,(224,224, 3)).transpose(2, 0, 1))
                image = cv2.resize(image,(224,224))
                images_list.append(image.transpose((2, 0, 1)))
            # identity_list.append(np.load(identity_path, allow_pickle=True))
            # audio_feature_list.append(audio_feature[k])

        # images_224_array = torch.from_numpy(np.array(images_224_lists)).type(dtype=torch.float32)
        images_array = torch.from_numpy(np.array(images_list)).type(dtype=torch.float32)
        kpt_array = torch.from_numpy(np.array(kpt_list)).type(dtype=torch.float32)

        dense_kpt_array = torch.from_numpy(np.array(dense_kpt_list)).type(dtype=torch.float32)
        mask_array = torch.from_numpy(np.array(mask_list)).type(dtype=torch.float32)
        # identity_array = torch.from_numpy(np.array(identity_list))
        # audio_feature_array = torch.from_numpy(np.array(audio_feature_list))
        # print('id:', idx, '\nfirst name: ',imagesName[0])
        if idx+1==len(self.masksList) or idx == 0:
            random.shuffle(self.MEADAll)
            self.masksList = self.MEADAll[:3000] + glob(os.path.join(self.source2, "*/*/")) + glob(
                os.path.join(self.source2, "*/*/")) + glob(os.path.join(self.source2, "*/*/")) + glob(
                os.path.join(self.source2, "*/*/")) + glob(os.path.join(self.source2, "*/*/")) + glob(
                os.path.join(self.source2, "*/*/"))  # [26400:26400+40] #[736+782+615:]# [267+219+58:267+219+58+90] #
        # print(imagesName)


        data_dict = {
            'image_224': images_array,
            'imagesName':imagesName,
            # 'image': images_array,
            'landmark': kpt_array,
            'landmark_dense': dense_kpt_array,
            'mask': mask_array,
            # 'au': torch.zeros(0),
            # 'mask': mask_array
        }
        return data_dict


    def load_mask(self, maskpath, h, w):
        if os.path.isfile(maskpath):
            vis_parsing_anno = np.load(maskpath)

            # mask = np.zeros_like(vis_parsing_anno)
            mask = np.zeros((h, w, 3))
            # mask = np.zeros((h, w))

            # index = vis_parsing_anno > 0
            mask[vis_parsing_anno > 0] = 1.
            mask[vis_parsing_anno == 4] = 2.
            mask[vis_parsing_anno == 5] = 2.
            mask[vis_parsing_anno == 9] = 2.
            mask[vis_parsing_anno == 7] = 2.
            mask[vis_parsing_anno == 8] = 2.
            mask[vis_parsing_anno == 10] = 0  # hair
            mask[vis_parsing_anno == 11] = 0  # left ear
            mask[vis_parsing_anno == 12] = 0  # right ear
            mask[vis_parsing_anno == 13] = 0  # glasses
            # print('shape...',mask.shape)
        else:
            mask = np.ones((h, w, 3))
            # mask = np.ones((h, w))
        return mask


