# ============================================================================
# í•™ìŠµ ë°©ë²• ê°€ì´ë“œ (Training Guide)
# ============================================================================
# 
# ì´ ì„¤ì • íŒŒì¼ì€ Coarse ëª¨ë¸ê³¼ Detail ëª¨ë¸ì„ ë…ë¦½ì ìœ¼ë¡œ ë˜ëŠ” í•¨ê»˜ í•™ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
#
# ã€í•™ìŠµ ëª¨ë“œ ì„¤ì •ã€‘
# train ì„¹ì…˜ì—ì„œ ë‹¤ìŒ ì˜µì…˜ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
#   - train_coarse: True/False  (Coarse ëª¨ë¸ í•™ìŠµ ì—¬ë¶€)
#   - train_detail: True/False  (Detail ëª¨ë¸ í•™ìŠµ ì—¬ë¶€)
#   * ìµœì†Œ í•˜ë‚˜ëŠ” Trueì—¬ì•¼ í•©ë‹ˆë‹¤.
#
# ã€ê°€ì¤‘ì¹˜ ë¡œë”© ë°©ë²•ã€‘
#
# 1. pretrained_modelpath:
#    - ì „ì²´ ëª¨ë¸ ê°€ì¤‘ì¹˜ë¥¼ ë¡œë“œí•©ë‹ˆë‹¤ (E_flame, E_detail, D_detail, BiViT, ViTDetail)
#    - ë¹ˆ ë¬¸ìì—´('')ì´ë©´ ì²˜ìŒë¶€í„° í•™ìŠµí•©ë‹ˆë‹¤
#
# 2. pretrained_coarse_modelpath:
#    - Coarse ëª¨ë¸ ê°€ì¤‘ì¹˜ë§Œ ë¡œë“œí•©ë‹ˆë‹¤ (E_flame, BiViT)
#    - pretrained_modelpathì—ì„œ ë¡œë“œí•œ E_flameê³¼ BiViTë¥¼ ë®ì–´ì”ë‹ˆë‹¤
#    - train_coarse=Falseì¼ ë•ŒëŠ” ë°˜ë“œì‹œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤ (ì—ëŸ¬ ë°œìƒ)
#    - train_coarse=Trueì¼ ë•ŒëŠ” ì„ íƒì‚¬í•­ì…ë‹ˆë‹¤ (ì—†ìœ¼ë©´ ì²˜ìŒë¶€í„° í•™ìŠµ)
#
# ã€í•™ìŠµ ì‹œë‚˜ë¦¬ì˜¤ ì˜ˆì‹œã€‘
#
# ì‹œë‚˜ë¦¬ì˜¤ 1: Coarseë§Œ í•™ìŠµ (train_coarse=True, train_detail=False)
#   - pretrained_coarse_modelpath: ì„¤ì •í•˜ë©´ íŒŒì¸íŠœë‹, ì—†ìœ¼ë©´ ì²˜ìŒë¶€í„° í•™ìŠµ
#
# ì‹œë‚˜ë¦¬ì˜¤ 2: Detailë§Œ í•™ìŠµ (train_coarse=False, train_detail=True)
#   - pretrained_coarse_modelpath: ë°˜ë“œì‹œ ì„¤ì • í•„ìš” (Coarse ëª¨ë¸ freeze)
#   - pretrained_modelpath: Detail ëª¨ë¸ ì´ˆê¸°í™”ìš© (ì„ íƒì‚¬í•­)
#
# ì‹œë‚˜ë¦¬ì˜¤ 3: ë‘˜ ë‹¤ í•™ìŠµ (train_coarse=True, train_detail=True)
#   - pretrained_modelpath: ì „ì²´ ëª¨ë¸ ì´ˆê¸°í™”ìš© (ì„ íƒì‚¬í•­)
#   - pretrained_coarse_modelpath: Coarse ëª¨ë¸ ì´ˆê¸°í™”ìš© (ì„ íƒì‚¬í•­)
#
# ã€ì£¼ì˜ì‚¬í•­ã€‘
# - pretrained_coarse_modelpathê°€ ìˆìœ¼ë©´ í•­ìƒ ë¡œë“œë˜ë©°, pretrained_modelpathì˜ 
#   E_flameê³¼ BiViTë¥¼ ë®ì–´ì”ë‹ˆë‹¤ (ì˜ë„ëœ ë™ì‘)
# - train_coarse=Falseì¸ë° pretrained_coarse_modelpathê°€ ì—†ìœ¼ë©´ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤
#
# ============================================================================
# '''
# '''
# first step:
# pre-train the coarse model (i.e.ğ¸ğ‘) for two epochs with a batch size of 64,
# with ğœ†ğ‘™ğ‘šğ‘˜=1ğ‘’âˆ’4, ğœ†ğ‘’ğ‘¦ğ‘’=1.0, ğœ†ğœ·=1ğ‘’âˆ’4, and ğœ†ğ=1ğ‘’âˆ’4

# Why:
# training with only lmk loss for good initialization,
# because the use of photometric loss needs good initialization both in regression and optimization
# and also, photometric loss needs differentiable rendering that makes the training slow
#
#
# '''
output_dir: "/media/cine/First/HWPJ2/ProjectResult/DetailNewBranch_decodertrain_onlyangry/"
pretrained_modelpath: ''
pretrained_coarse_modelpath: '/media/cine/First/HJCode2/AUSequence/Training1_videoC_OnlyE_AULossF/pretrain2/model.tar'
#model_path_HJ: '/home/cine/Documents/HJCode/GANE_code/Training/testGATE30/model.tar'
multi_gpu: False #True/False
device: 'cuda:0'           # Coarse ëª¨ë¸ìš© GPU
device_detail: 'cuda:1'    # Detail ëª¨ë¸ìš© GPU (ì´ê²ƒì´ ì—†ìœ¼ë©´ ë‘˜ ë‹¤ cuda:0 ì‚¬ìš©!)
dataset:
  batch_size: 1
  K: 3 #K =windowsize
loss:
  #  expression: 0.0
  #  eyed: 0.3
  #  id: 0.0
  #  lipd: 0.05
  #  lipread: 0.0
  #  lmk: 2.0
  #  lmk_mp: 2.0
  #  photo: 0.0
  #  reg_exp: 0.001
  #  reg_jaw_pose: 0.0
  #  reg_light: 0.0
  #  reg_shape: 0.0001
  #  reg_tex: 0.0
  #  relaL: 0.2
  expression: 7.0
  eyed: 1.
  lipd: 0.0
  lmk: 8.0
  lmk_mp: 8.0
  photo: 5.0
  reg_exp: 1e-04
  reg_jaw_pose: 0.01
  #  reg_light: 0.0
  reg_shape: 0.0
  #  reg_tex: 0.
  #  reg_light: 0.
  reg_tex: 1e-04
  reg_light: 1.
  #  reg_tex: 0.0
  relaL: 1.
  AUFLoss: 1.
  mainAU: 0.5
  subAU: 0.25
  weightedAU: False
  focalAU: False
train:
  # í•™ìŠµ ëª¨ë“œ ì„¤ì • (ìµœì†Œ í•˜ë‚˜ëŠ” Trueì—¬ì•¼ í•¨)
  train_coarse: True   # Coarse ëª¨ë¸(BiViT) í•™ìŠµ ì—¬ë¶€
  train_detail: True   # Detail ëª¨ë¸(ViTDetail, D_detail) í•™ìŠµ ì—¬ë¶€
  
  resume: True
  max_epochs: 50
  max_steps: 1000000000000000000
  log_steps: 1000
  vis_steps: 1000
  checkpoint_steps: 500
  #  val_steps: 500
  #  eval_steps: 1000
  #  lr: 1e-4
  lr: 1e-4
model:
  use_tex: True
