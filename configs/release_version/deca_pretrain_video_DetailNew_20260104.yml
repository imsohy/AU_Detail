# ì‹¤í—˜ì¼ì:2026 01 04 shape ì¶”ê°€
# ============================================================================
# í•™ìŠµ ë°©ë²• ê°€ì´ë“œ (Training Guide)
# ============================================================================
# 
# ì´ ì„¤ì • íŒŒì¼ì€ Coarse ëª¨ë¸ê³¼ Detail ëª¨ë¸ì„ ë…ë¦½ì ìœ¼ë¡œ ë˜ëŠ” í•¨ê»˜ í•™ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
#
# ã€í•™ìŠµ ëª¨ë“œ ì„¤ì •ã€‘
# train ì„¹ì…˜ì—ì„œ ë‹¤ìŒ ì˜µì…˜ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: ìµœì†Œ í•˜ë‚˜ëŠ” Trueì—¬ì•¼ í•©ë‹ˆë‹¤.
#   - train_coarse: True/False  (Coarse ëª¨ë¸ í•™ìŠµ ì—¬ë¶€)
#   - train_detail: True/False  (Detail ëª¨ë¸ í•™ìŠµ ì—¬ë¶€)
# ë‹¤ìŒì€ ê·¸ëƒ¥ ê°€ëŠ¥.
#   - train_decoder: True/False  (Decoder í•™ìŠµ ì—¬ë¶€)
# ============================================================================
# '''
# first step:
# pre-train the coarse model (i.e.ğ¸ğ‘) for two epochs with a batch size of 64,
# with ğœ†ğ‘™ğ‘šğ‘˜=1ğ‘’âˆ’4, ğœ†ğ‘’ğ‘¦ğ‘’=1.0, ğœ†ğœ·=1ğ‘’âˆ’4, and ğœ†ğ=1ğ‘’âˆ’4

# Why:
# training with only lmk loss for good initialization,
# because the use of photometric loss needs good initialization both in regression and optimization
# and also, photometric loss needs differentiable rendering that makes the training slow
#
#
# '''
output_dir: "/media/cine/First/HWPJ2/ProjectResult/DetailNew_20260104/"
pretrained_modelpath: ''
pretrained_coarse_modelpath: '/media/cine/First/HJCode2/AUSequence/Training1_videoC_OnlyE_AULossF/pretrain2/model.tar'
#model_path_HJ: '/home/cine/Documents/HJCode/GANE_code/Training/testGATE30/model.tar'
multi_gpu: False #True/False
device: 'cuda:0'           # Coarse ëª¨ë¸ìš© GPU
device_detail: 'cuda:1'    # Detail ëª¨ë¸ìš© GPU (ì´ê²ƒì´ ì—†ìœ¼ë©´ ë‘˜ ë‹¤ cuda:0 ì‚¬ìš©!)
dataset:
  batch_size: 1
  K: 3 #K =windowsize
loss:
  #  expression: 0.0
  #  eyed: 0.3
  #  id: 0.0
  #  lipd: 0.05
  #  lipread: 0.0
  #  lmk: 2.0
  #  lmk_mp: 2.0
  #  photo: 0.0
  #  reg_exp: 0.001
  #  reg_jaw_pose: 0.0
  #  reg_light: 0.0
  #  reg_shape: 0.0001
  #  reg_tex: 0.0
  #  relaL: 0.2
  expression: 7.0
  eyed: 1.
  lipd: 0.0
  lmk: 8.0
  lmk_mp: 8.0
  photo: 5.0
  reg_exp: 1e-04
  reg_jaw_pose: 0.01
  #  reg_light: 0.0
  reg_shape: 0.0
  #  reg_tex: 0.
  #  reg_light: 0.
  reg_tex: 1e-04
  reg_light: 1.
  #  reg_tex: 0.0
  relaL: 1.
  AUFLoss: 1.
  mainAU: 0.5
  subAU: 0.25
  weightedAU: False
  focalAU: False

#mrf = 5e-2
#photo_D = 2.
#reg_sym = 0.005
#reg_z = 0.005
#reg_diff = 0.005
#au_D = 0.0

train:
  # í•™ìŠµ ëª¨ë“œ ì„¤ì • (ìµœì†Œ í•˜ë‚˜ëŠ” Trueì—¬ì•¼ í•¨)
  train_coarse: False   # Coarse ëª¨ë¸(BiViT) í•™ìŠµ ì—¬ë¶€
  train_detail: True   # Detail ëª¨ë¸(ViTDetail, D_detail) í•™ìŠµ ì—¬ë¶€
  train_decoder: False   # Decoder í•™ìŠµ ì—¬ë¶€

  resume: True
  max_epochs: 50
  max_steps: 1000000000000000000
  log_steps: 1000
  vis_steps: 1000
  checkpoint_steps: 500
  #  val_steps: 500
  #  eval_steps: 1000
  #  lr: 1e-4
  lr: 1e-4
model:
  use_tex: True
