# ì‹¤í—˜ì¼ì: 20260125
# OnlyExpressionA ë°©ì‹: Coarse ViTê°€ expressionë§Œ ì¶”ë¡ í•˜ê³ , texì™€ lightëŠ” DECAì—ì„œ ê°€ì ¸ì˜´.
# Coarse í•™ìŠµìš© ì„¤ì • (OnlyE ë²„ì „ - AU Loss ìˆìŒ)
# ============================================================================
# í•™ìŠµ ë°©ë²• ê°€ì´ë“œ (Training Guide)
# ============================================================================
# 
# ì´ ì„¤ì • íŒŒì¼ì€ Coarse ëª¨ë¸(BiViT)ì„ í•™ìŠµí•˜ê¸° ìœ„í•œ ì„¤ì •ì…ë‹ˆë‹¤.
#
# ã€í•™ìŠµ ëª¨ë“œ ì„¤ì •ã€‘
# train ì„¹ì…˜ì—ì„œ ë‹¤ìŒ ì˜µì…˜ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: ìµœì†Œ í•˜ë‚˜ëŠ” Trueì—¬ì•¼ í•©ë‹ˆë‹¤.
#   - train_coarse: True/False  (Coarse ëª¨ë¸ í•™ìŠµ ì—¬ë¶€)
#   - train_detail: True/False  (Detail ëª¨ë¸ í•™ìŠµ ì—¬ë¶€)
#   - train_decoder: True/False  (Decoder í•™ìŠµ ì—¬ë¶€)
# ============================================================================
# '''
# first step:
# pre-train the coarse model (i.e.ğ¸ğ‘) for two epochs with a batch size of 64,
# with ğœ†ğ‘™ğ‘šğ‘˜=1ğ‘’âˆ’4, ğœ†ğ‘’ğ‘¦ğ‘’=1.0, ğœ†ğœ·=1ğ‘’âˆ’4, and ğœ†ğ=1ğ‘’âˆ’4
#
# Why:
# training with only lmk loss for good initialization,
# because the use of photometric loss needs good initialization both in regression and optimization
# and also, photometric loss needs differentiable rendering that makes the training slow
#
#
# '''
output_dir: "/media/cine/First/HWPJ2/ProjectResult/DetailNew_20260125_onlyE_OnlyE/"
pretrained_modelpath: ''
pretrained_coarse_modelpath: ''  # Coarseë¥¼ í•™ìŠµì‹œí‚¤ë¯€ë¡œ ë¹ˆ ê²½ë¡œì—¬ë„ ì‘ë™í•¨
#model_path_HJ: '/home/cine/Documents/HJCode/GANE_code/Training/testGATE30/model.tar'
dataset:
  batch_size: 1
  K: 3  # K = windowsize
loss:
  expression: 0.8
  eyed: 0.05
  lipd: 0.0
  lmk: 0.7
  lmk_mp: 1.0
  photo: 0.0
  reg_exp: 1e-04
  reg_jaw_pose: 0.0
  #  reg_light: 0.0
  reg_shape: 0.0
  #  reg_tex: 0.
  #  reg_light: 0.
  reg_tex: 0.
  reg_light: 0.
  #  reg_tex: 0.0
  relaL: 0.08
  AUFLoss: 1.      # AU Loss í™œì„±í™” (OnlyE ë²„ì „)
  mainAU: 0.5
  subAU: 0.25
  weightedAU: False
  focalAU: False
# Detail loss ê°’ë“¤ (ì£¼ì„ ì²˜ë¦¬ - Coarse í•™ìŠµìš©ì´ë¯€ë¡œ)
#mrf = 5e-2
#photo_D = 2.
#reg_sym = 0.005
#reg_z = 0.005
#reg_diff = 0.005
#au_D = 0.0

train:
  # í•™ìŠµ ëª¨ë“œ ì„¤ì • (ìµœì†Œ í•˜ë‚˜ëŠ” Trueì—¬ì•¼ í•¨)
  train_coarse: True   # Coarse ëª¨ë¸(BiViT) í•™ìŠµ ì—¬ë¶€
  train_detail: False   # Detail ëª¨ë¸(ViTDetail, D_detail) í•™ìŠµ ì—¬ë¶€
  train_decoder: False   # Decoder í•™ìŠµ ì—¬ë¶€

  resume: True
  max_epochs: 25
  max_steps: 1000000000000000000
  log_steps: 1000
  vis_steps: 1000
  checkpoint_steps: 500
  #  val_steps: 500
  #  eval_steps: 1000
  #  lr: 1e-4
  lr: 1e-4
model:
  use_tex: True

