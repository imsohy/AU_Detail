# ============================================================================
# Detail í•™ìŠµ ì„¤ì • (Detail Training Configuration)
# ============================================================================
# 
# ì´ ì„¤ì • íŒŒì¼ì€ ì´ë¯¸ í•™ìŠµëœ Coarse ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ Detailë§Œ í•™ìŠµí•©ë‹ˆë‹¤.
#
# ã€í•™ìŠµ ëª¨ë“œ ì„¤ì •ã€‘
# train ì„¹ì…˜ì—ì„œ ë‹¤ìŒ ì˜µì…˜ì„ ì„¤ì •í•©ë‹ˆë‹¤:
#   - train_coarse: False   (Coarse ëª¨ë¸ freeze)
#   - train_detail: True    (Detail ëª¨ë¸ í•™ìŠµ)
#   - train_decoder: False  (Decoder í•™ìŠµ ì•ˆ í•¨, ViTDetailë§Œ í•™ìŠµ)
#
# ã€ê°€ì¤‘ì¹˜ ë¡œë”© ë°©ë²•ã€‘
#
# 1. pretrained_coarse_modelpath:
#    - ë°˜ë“œì‹œ ì„¤ì • í•„ìš”! (í•™ìŠµëœ Coarse ëª¨ë¸ ê²½ë¡œ)
#    - ì´ ê²½ë¡œì˜ E_flameê³¼ BiViTë¥¼ ë¡œë“œí•˜ì—¬ freezeí•©ë‹ˆë‹¤
#
# 2. pretrained_modelpath:
#    - Detail ëª¨ë¸ ì´ˆê¸°í™”ìš© (ì„ íƒì‚¬í•­)
#    - ë¹ˆ ë¬¸ìì—´('')ì´ë©´ Detail ëª¨ë¸ì€ ì²˜ìŒë¶€í„° í•™ìŠµí•©ë‹ˆë‹¤
#
# ã€Coarse Loss ì„¤ì •ã€‘
# - deca_pretrain_video_OnlyE.ymlê³¼ ë™ì¼í•œ Coarse loss ê°€ì¤‘ì¹˜ ì‚¬ìš©
# - train_coarse=Falseì´ë¯€ë¡œ ì‹¤ì œë¡œëŠ” ì‚¬ìš©ë˜ì§€ ì•Šì§€ë§Œ, ì„¤ì •ì€ ìœ ì§€
#
# ============================================================================
# '''
# first step:
# pre-train the coarse model (i.e.ğ¸ğ‘) for two epochs with a batch size of 64,
# with ğœ†ğ‘™ğ‘šğ‘˜=1ğ‘’âˆ’4, ğœ†ğ‘’ğ‘¦ğ‘’=1.0, ğœ†ğœ·=1ğ‘’âˆ’4, and ğœ†ğ=1ğ‘’âˆ’4
#
# Why:
# training with only lmk loss for good initialization,
# because the use of photometric loss needs good initialization both in regression and optimization
# and also, photometric loss needs differentiable rendering that makes the training slow
#
#
# '''
#output_dir: "Training/pretrain3_1024_i"
#output_dir: "Training/pretrain1_236"
#output_dir: "Training1_videoC_OnlyE/pretrain1X1"
output_dir: "/media/cine/de6afd1d-c444-4d43-a787-079519ace719/HJCode2/AUSequence/Training1_videoC_OnlyE_AULossF/detail_train"
pretrained_modelpath: ''
pretrained_coarse_modelpath: '/media/cine/de6afd1d-c444-4d43-a787-079519ace719/HJCode2/AUSequence/Training1_videoC_OnlyE_AULossF/pretrainXXX/model.tar'  # âš ï¸ í•„ìˆ˜! í•™ìŠµëœ Coarse ëª¨ë¸ ê²½ë¡œ
#model_path_HJ: '/home/cine/Documents/HJCode/GANE_code/Training/testGATE30/model.tar'
dataset:
  batch_size: 1
  K: 1  # windowsize (Coarse í•™ìŠµ ì‹œì™€ ë™ì¼í•˜ê²Œ ì„¤ì •, ë˜ëŠ” í•„ìš”ì— ë”°ë¼ ì¡°ì •)
loss:
  # Coarse Loss ì„¤ì • (deca_pretrain_video_OnlyE.ymlê³¼ ë™ì¼)
  #  expression: 0.0
  #  eyed: 0.3
  #  id: 0.0
  #  lipd: 0.05
  #  lipread: 0.0
  #  lmk: 2.0
  #  lmk_mp: 2.0
  #  photo: 0.0
  #  reg_exp: 0.001
  #  reg_jaw_pose: 0.0
  #  reg_light: 0.0
  #  reg_shape: 0.0001
  #  reg_tex: 0.0
  #  relaL: 0.2
  expression: 0.8
  eyed: 0.05
  lipd: 0.0
  lmk: 0.7
  lmk_mp: 1.0
  photo: 0.0
  reg_exp: 1e-04
  reg_jaw_pose: 0.0
  #  reg_light: 0.0
  reg_shape: 0.0
  #  reg_tex: 0.
  #  reg_light: 0.
  reg_tex: 0.
  reg_light: 0.
  #  reg_tex: 0.0
  relaL: 0.08
  AUFLoss: 1.
  mainAU: 0.5
  subAU: 0.25
  weightedAU: False
  focalAU: False
  
  # Detail Loss ì„¤ì • (âš ï¸ ì¤‘ìš”: Detail í•™ìŠµì— í•„ìš”í•œ Loss ì„¤ì •)
  detail_consistency: True
  useConstraint: True
  mrf: 5e-2
  photo_D: 2.
  reg_sym: 0.005
  reg_z: 0.005
  reg_diff: 0.005
  au_D: 0.0
train:
  # í•™ìŠµ ëª¨ë“œ ì„¤ì •
  train_coarse: False   # Coarse ëª¨ë¸(BiViT) freeze
  train_detail: True    # Detail ëª¨ë¸(ViTDetail) í•™ìŠµ
  train_decoder: False  # Decoder(D_detail) í•™ìŠµ ì•ˆ í•¨ (ViTDetailë§Œ í•™ìŠµ)
  
  # Training ì„¤ì • (deca_pretrain_video_OnlyE.ymlê³¼ ë™ì¼)
  resume: True
  max_epochs: 25
  max_steps: 1000000000000000000
  log_steps: 1000
  vis_steps: 1000
  checkpoint_steps: 500
  #  val_steps: 500
  #  eval_steps: 1000
  #  lr: 1e-4
  lr: 1e-4
model:
  use_tex: True

